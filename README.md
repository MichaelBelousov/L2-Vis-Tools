# L2VisTools

### This is a partially redacted dump of scripts and tools for some graphical network auditing, using nmap, CISCO routers + CDP, SNMP, and etc

###### Version 0.0.2

Python3.6 tools to gather data on layer 2 networks, and generate well-formed XML data and visualizations of it.
Meant for use both via command line, and extending in python, developed primarily for the SecurityApps L2Vis app.
See the arg-parse generated usage and help for each script.

---
### <a name="Scripts"></a>Scripts
---

### <a name="trace.py"></a>trace.py

**trace.py** runs an nmap scan, and stores the result in the used [XML schema](#XMLSchema)

### <a name="sheet.py"></a>sheet.py

**sheet.py** takes nmap data generated by trace.py and generates 
formats compatible with spreadsheets, currently plain *csv* files.
table-structured xml file named  in the private directory.

*It could be helpful to use XSLT*

### <a name="visio.py"></a>visio.py

Generates visualizations of networks scanned by trace.py as svgs

*PDF support should be readded*

### <a name="hosttypes.py"></a>hosttypes.py

Uses basic pattern matching (regex) to guess types for each host scanned from a previous **trace.py** run. The data generated by this is error-prone and needs human correction.  
This will be modified in the future to pull information from other sources.

### <a name="graphutils.py"></a>graphutils.py

Contains the functions for creating SVGs from networkx graphs

### <a name="batch_cisco_tracemac.py"></a>batch_cisco_tracemac.py

A command line utility for mapping VRFs from their cam tables in routers.
Originally used and intended for REDACTED.

### <a name="snmptrace.py"></a>snmptrace.py

SNMP (and CDP) based mac tracer, to emulate cisco's tracemac utility using SNMP.

*not finished*

---
## <a name="Modules"></a>Modules
---

### <a name="ciscotraceparser.py"></a>ciscotraceparser.py

parsers for cisco router cli output and prompts, with a command line
interface for converting a log of `show ip arp vrf` followed by
`tracemac`'s to the common XML schema.

### <a name="complement.py"></a>complement.py

logical complement of netaddr IPSet collection

### <a name="svgwriteplus.py"></a>svgwriteplus.py

light wrapper/superset of the svgwrite module

### <a name="graphfile.py"></a>graphfile.py

simple graph description format (parser) for manually writing
out graphs

---
## <a name="XMLSchema"></a>XML Schema
---

The common XML schema used by the applications is of the following structure:

```XML
<networks>
  <network>
    <networkname/>
    <hosts>
      <host>
        <hostname/>
        <address/>
        <traceblob/>
        <trace>
          <hop>
            <index/>
            <hostname/>
            <address/>
```

---
## <a name="Requirements"></a>Requirements and Setup
---

L2VisTools expects the following resources:
- `icons/` is expected to be a directory of svgs icons used in **hosttype.py**
  this should be configurable

The following PyPI packages are employed:
- xmltodict
- oset
- networkx (could be replaced for self-containment)
- svgwrite
- netmiko
- pyparsing
- validators
- easysnmp
- securitycenter

The following software packages are used:
- inkscape (optional, for PDF support)
